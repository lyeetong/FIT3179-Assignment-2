{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "background": "black",
  "width": 1000,
  "height": 500,

  "params":[
  {
 "name": "zoom_level",
 "value": 150,
 "bind": {
 "input": "range",
 "min": 100,
 "max": 300,
 "step": 50,
 "name": "Zoom: "
 }
 }, {
 "name": "center_to",
 "value": [0,0],
 "bind": {
 "input": "select",
 "options": [
  [0, 0],
 [81, 144],
 [-60, -22],
 [9, 1],
 [130, -30], [-90, 120]
 ],
 "labels": ["Whole map", "Asia & Europe", "South America", "Africa", "Asia Pacific", "North America"],
 "name": "Map Centre: "
 }
 }],
   "projection": {"type": "equalEarth",  "scale": {"expr": "zoom_level"}, "rotate": [-20, 0, 0], "center":  {"expr": "center_to"}},
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/KaneSec/vega_lite/main/2_symbol_map/js/ne_110m_admin_0_countries.topojson",
        "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
      },
      "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"}
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/KaneSec/vega_lite/main/3_choropleth_map/js/ne_110m_admin_0_countries.topojson",
        "format": {
          "type": "topojson",
          "feature": "ne_110m_admin_0_countries",
          "parse": {"properties.POP_EST": "number"}
        }
      },
      "transform": [
        {
          "lookup": "properties.NAME",
          "from": {
            "data": {
              "url": "https://raw.githubusercontent.com/lyeetong/FIT3179-Assignment-2/main/avg_deaths_by_countries_over_years.csv"
            },
            "key": "Country",
            "fields": [
              "Smoking",
              "Unsafe sex",
              "Alcohol use",
              "Drug use",
              "Low physical activity",
              "Diet low in fruits",
              "Diet low in vegetables",
              "Diet high in sodium",
              "Diet low in whole grains",
              "Diet low in nuts and seeds"
            ]
          }
        },
        {
          "calculate": "parseFloat(datum.Smoking)+parseFloat(datum['Unsafe sex'])+parseFloat(datum['Alcohol use'])+parseFloat(datum['Low physical activity'])+parseFloat(datum['Drug use'])",
          "as": "Death Count by Physical Habits"
        },
        {
          "calculate": "parseFloat(datum['Diet low in vegetables'])+parseFloat(datum['Diet low in fruits'])+parseFloat(datum['Diet high in sodium'])+parseFloat(datum['Diet low in whole grains'])+parseFloat(datum['Diet low in nuts and seeds'])",
          "as": "Death Count by Diet Practices"
        },
        {"calculate": "datum.properties.POP_EST", "as": "Population"},
        {
          "calculate": "datum['Death Count by Physical Habits']/datum.properties.POP_EST*100000",
          "as": "Deaths by Physical Habits"
        },
        {
          "calculate": "datum['Death Count by Diet Practices']/datum.properties.POP_EST*100000",
          "as": "Deaths by Diet Practices"
        },
        {
          "calculate": "datum['Deaths by Physical Habits']+datum['Deaths by Diet Practices']",
          "as": "Total Deaths"
        }
      ],
      "mark": {"type": "geoshape"},
      "encoding": {
        "color": {
          "field": "Total Deaths",
          "type": "quantitative",
          "scale": {
            "type": "threshold",
            "domain": [140, 280, 420, 560, 700, 840, 980],
            "range": [
              "#FFFFE0",
              "#FFCB6E",
              "#FF7F50",
              "#FF6347",
              "#FF4500",
              "#DC143C",
              "#B22222",
              "#8B0000"
            ]
          },
          "legend": {"orient": "top-left", "direction": "horizontal", "labelColor": "white", "titleColor": "white"}
        },
        "tooltip": [
          {"field": "properties.NAME", "type": "nominal", "title": "Country"},
          {
            "field": "Deaths by Physical Habits",
            "type": "quantitative",
            "format": ".2f"
          },
          {
            "field": "Deaths by Diet Practices",
            "type": "quantitative",
            "format": ".2f"
          },
          {
            "field": "Total Deaths",
            "type": "quantitative",
            "format": ".2f"
          }
        ]
      }
    }
  ],
  "config": {"view": {"stroke": "transparent"}}
}
